---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import MetaBar from '../components/MetaBar.astro';
import ComicImage from '../components/ComicImage.astro';

export async function getStaticPaths() {
	const comics = await getCollection('comics');
	return comics.map((comic) => ({
		params: { slug: comic.id },
		props: { comic },
	}));
}

const { comic } = Astro.props;
---

<Layout
	title={comic.data.title}
	image={{ src: comic.data.cover.src, width: comic.data.cover.width, height: comic.data.cover.height }}
	type="article"
	publishedDate={comic.data.date}
	currentSlug={comic.id}
>
	<article>
		<div class="comic-grid grid grid-cols-1 md:grid-cols-2">
			{comic.data.pages.map((page, i) => (
				<ComicImage
					src={page}
					alt={`${comic.data.alt} â€” page ${i + 1}`}
					index={i}
				/>
			))}
		</div>
		<MetaBar
			date={comic.data.date}
			slug={comic.id}
			title={comic.data.title}
		/>
	</article>
</Layout>
